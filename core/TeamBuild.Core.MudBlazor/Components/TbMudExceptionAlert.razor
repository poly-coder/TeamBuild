@using global::MudBlazor
@using MudBlazor
@inherits TbExceptionAlert
@attribute [CustomView(TeamBuildCoreMudBlazor.UiSelector)]

@if (Exception is null)
{
    return;
}

<MudPaper Class="pa-4" Elevation="0">
    <MudStack Spacing="2">
        <MudButton OnClick="() => expanded = !expanded"
                   Color="Color.Error"
                   EndIcon="@ButtonIcon">
            @Title
            <MudSpacer />
        </MudButton>
        <MudDivider />
        <MudCollapse Expanded="@expanded">
            <MudGrid>
                <MudItem xs="12" md="4">
                    <MudText Typo="Typo.button">
                        Message:
                    </MudText>
                </MudItem>
                <MudItem xs="12" md="8">
                    <MudText Typo="Typo.body1">
                        @Exception.Message
                    </MudText>
                </MudItem>
                <MudItem xs="12" md="4">
                    <MudText Typo="Typo.button">
                        Type:
                    </MudText>
                </MudItem>
                <MudItem xs="12" md="8">
                    <MudText Typo="Typo.body1">
                        @Exception.GetType().FullName
                    </MudText>
                </MudItem>
                <MudItem xs="12" md="4">
                    <MudText Typo="Typo.button">
                        HResult:
                    </MudText>
                </MudItem>
                <MudItem xs="12" md="8">
                    <MudText Typo="Typo.body1">
                        0x@(Exception.HResult.ToString("X8"))
                    </MudText>
                </MudItem>
                <MudItem xs="12" md="4">
                    <MudText Typo="Typo.button">
                        Stack Trace:
                    </MudText>
                </MudItem>
                <MudItem xs="12" md="8">
                    <pre style="max-height: 300px; max-width: 100%; overflow-y: auto; overflow-x: auto;">
                        @Exception.StackTrace
                    </pre>
                </MudItem>
            </MudGrid>
        </MudCollapse>
    </MudStack>
</MudPaper>

@code
{
    private bool expanded;
    private string ButtonIcon => expanded ? Icons.Material.Filled.KeyboardArrowUp : Icons.Material.Filled.KeyboardArrowDown;

}
