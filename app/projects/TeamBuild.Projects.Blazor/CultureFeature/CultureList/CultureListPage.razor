@using TeamBuild.Projects.Application.CultureFeature

@attribute [Route(CultureRoutes.ListRoute)]

@inject NavigationManager Nav
@inject ICultureQueryService QueryService

<TbMudPage Title="@CultureRoutes.ListTitle"
           Breadcrumbs="@CultureRoutes.ListBreadcrumbs">
    <TopBar>
        <TbMudReloadButton Disabled="search?.IsRunning == true"
                           OnClick="() => search?.Execute(lastSearch)"/>
        <TbMudCopyButton CopyJson="@JsonContent" Label="Copy Json" />
        <TbMudGoToAddButton Href="@CultureRoutes.New()" />
    </TopBar>

    <ChildContent>
        @if (search is not null)
        {
            <TbMudLoadingBar IsLoading="@search.IsRunning" />

            @if (search.TryGetException(out var searchException))
            {
                <TbMudExceptionAlert Exception="searchException" />
            }

            <CultureListView OnSearch="f => search.Execute(f)"
                             CultureList="@cultureList"
                             OnViewCulture="HandleOnViewCulture"
                             OnEditCulture="HandleOnEditCulture"
                             OnDeleteCulture="HandleOnDeleteCulture" />
        }

    </ChildContent>
</TbMudPage>
